<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction · Medical Resonance Imaging</title><meta name="title" content="Introduction · Medical Resonance Imaging"/><meta property="og:title" content="Introduction · Medical Resonance Imaging"/><meta property="twitter:title" content="Introduction · Medical Resonance Imaging"/><meta name="description" content="Documentation for Medical Resonance Imaging."/><meta property="og:description" content="Documentation for Medical Resonance Imaging."/><meta property="twitter:description" content="Documentation for Medical Resonance Imaging."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script><link href="https://control-toolbox.org/assets/css/documentation.css" rel="stylesheet" type="text/css"/><script src="https://control-toolbox.org/assets/js/documentation.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">Medical Resonance Imaging</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href="index.html">Introduction</a><ul class="internal"><li><a class="tocitem" href="#Introduction"><span>Introduction</span></a></li><li><a class="tocitem" href="#Dependencies"><span>Dependencies</span></a></li></ul></li><li><a class="tocitem" href="bloch-equation.html">Bloch equation</a></li><li><a class="tocitem" href="saturation.html">Saturation problem</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="index.html">Introduction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="index.html">Introduction</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/control-toolbox/medical_resonance_imaging" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/control-toolbox/medical_resonance_imaging/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Optimal-control-in-Medical-Resonance-Imaging"><a class="docs-heading-anchor" href="#Optimal-control-in-Medical-Resonance-Imaging">Optimal control in Medical Resonance Imaging</a><a id="Optimal-control-in-Medical-Resonance-Imaging-1"></a><a class="docs-heading-anchor-permalink" href="#Optimal-control-in-Medical-Resonance-Imaging" title="Permalink"></a></h1><h2 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h2><p>From the 2010 survey<sup class="footnote-reference"><a id="citeref-1" href="#footnote-1">[1]</a></sup>, one of the earliest examples of coherent control of quantum dynamics  is manipulation of nuclear spin ensembles using radiofrequency (RF) fields<sup class="footnote-reference"><a id="citeref-2" href="#footnote-2">[2]</a></sup>.  This manipulation is possible due to the Nuclear Magnetic Resonance (NMR) phenomenon<sup class="footnote-reference"><a id="citeref-3" href="#footnote-3">[3]</a></sup> <sup class="footnote-reference"><a id="citeref-4" href="#footnote-4">[4]</a></sup> which has become a very powerful tool to study matter in a variety of domains from biology  and chemistry to solid physics and quantum mechanics. Two of the main applications of NMR  control techniques are maybe high-resolution spectroscopy and Magnetic Resonance Imaging (MRI).</p><p>MRI is a medical imaging technique used to produce pictures of the anatomy and investigate  physiological processes of the body. The general principles involve the interaction of matter  with electromagnetic fields and are the following. When a sample of matter, in liquid phase,  is inside a strong and uniform longitudinal magnetic field (<span>$B_0$</span>), the magnetic moments of the spin-<span>$1/2$</span> particles align with the direction of this field. When a transverse radio-frequency magnetic pulse (<span>$B_1$</span>) is then applied, the sample alter its magnetization  alignment relative to the field and its characteristics (the relaxation times <span>$T_1$</span> and <span>$T_2$</span>). These changes in magnetization alignment produce a changing magnetic flux, which  yields to the emission of an electric signal which is detected and amplified. Then, the image  is obtained by the analysis of the Fourier transform of this signal. One key point of this  process is the control of the magnetization vector via the magnetic pulse. To do that, many different control strategies already exists<sup class="footnote-reference"><a id="citeref-4" href="#footnote-4">[4]</a></sup>, but the majority are based  upon heuristic reasoning<sup class="footnote-reference"><a id="citeref-5" href="#footnote-5">[5]</a></sup> <sup class="footnote-reference"><a id="citeref-6" href="#footnote-6">[6]</a></sup>.</p><p><img src="mri-resources/mri.jpg" alt="MRI"/></p><p>Optimal control algorithms were introduced in NMR to improve control field sequences  recently<sup class="footnote-reference"><a id="citeref-7" href="#footnote-7">[7]</a></sup> and at the end of the nineties, new methods appeared in optimal control of NMR  systems both from the analytical and numerical points of view<sup class="footnote-reference"><a id="citeref-8" href="#footnote-8">[8]</a></sup> <sup class="footnote-reference"><a id="citeref-9" href="#footnote-9">[9]</a></sup>. More recently, the  combination of geometric optimal control based on the Maximum Principle<sup class="footnote-reference"><a id="citeref-10" href="#footnote-10">[10]</a></sup> and related  numerical algorithms (gradient methods<sup class="footnote-reference"><a id="citeref-11" href="#footnote-11">[11]</a></sup>, shooting and continuation methods<sup class="footnote-reference"><a id="citeref-12" href="#footnote-12">[12]</a></sup>) leads  to sophisticated results about the time-minimal saturation problem (which consists in bringing  the magnetization vector to zero, <em>i.e.</em> the state to the origin) of a single spin<sup class="footnote-reference"><a id="citeref-13" href="#footnote-13">[13]</a></sup> with applications to the contrast problem in MRI, see<sup class="footnote-reference"><a id="citeref-14" href="#footnote-14">[14]</a></sup> <sup class="footnote-reference"><a id="citeref-15" href="#footnote-15">[15]</a></sup>. They are the basis to  numerical computations of <em>robust optimal controls</em> which take into account inhomogeneities  contained in the <span>$B_0$</span> and <span>$B_1$</span> magnetic fields and which have been validated very recently  by <em>in vitro</em> and <em>in vivo</em> experiments, see for instance <sup class="footnote-reference"><a id="citeref-16" href="#footnote-16">[16]</a></sup> <sup class="footnote-reference"><a id="citeref-17" href="#footnote-17">[17]</a></sup>.</p><div class="admonition is-info"><header class="admonition-header">2022 survey</header><div class="admonition-body"><p>This background overview is not up-to-date. We refer to <sup class="footnote-reference"><a id="citeref-18" href="#footnote-18">[18]</a></sup> for more details.</p></div></div><h2 id="Dependencies"><a class="docs-heading-anchor" href="#Dependencies">Dependencies</a><a id="Dependencies-1"></a><a class="docs-heading-anchor-permalink" href="#Dependencies" title="Permalink"></a></h2><p>All the numerical simulations to generate this documentation from <code>MRI.jl</code> are performed with  the following packages.</p><pre><code class="language-julia hljs">using Pkg
Pkg.status()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Status `~/work/medical_resonance_imaging/medical_resonance_imaging/docs/Project.toml`
⌅ [1c39547c] CTFlows v0.4.5
  [e30172f5] Documenter v1.6.0
  [93e74489] MedicalResonanceImaging v0.1.5 `~/work/medical_resonance_imaging/medical_resonance_imaging`
  [f4238b75] NLPModelsIpopt v0.10.2
  [8913a72c] NonlinearSolve v3.14.0
⌅ [5f98b655] OptimalControl v0.9.4
  [1dea7af3] OrdinaryDiffEq v6.88.1
  [91a5bcdd] Plots v1.40.5
  [fd094767] Suppressor v0.2.8
  [37e2e46d] LinearAlgebra
Info Packages marked with ⌅ have new versions available but compatibility constraints restrict them from upgrading. To see why use `status --outdated`</code></pre><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-1"><a class="tag is-link" href="#citeref-1">1</a>C. Brif, R. Chakrabarti &amp; H. Rabitz, <em>Control of Quantum Phenomena: Past, Present and Future</em>, New Journal for Physics, <strong>12</strong> (2010), pp.1–68.</li><li class="footnote" id="footnote-2"><a class="tag is-link" href="#citeref-2">2</a>A. Abragam, <em>The Principles of Nucelar Magnetism</em>, Oxford University Press, London (1961).</li><li class="footnote" id="footnote-3"><a class="tag is-link" href="#citeref-3">3</a>R. R. Ernst, <em>Principles of Nuclear Magnetic Resonance in one and two dimensions</em> International Series of Monographs on Chemistry, Oxford University Press, Oxford (1990).</li><li class="footnote" id="footnote-4"><a class="tag is-link" href="#citeref-4">4</a>M. H. Levitt, <em>Spin dynamics: Basics of Nuclear Magnetic Resonance</em>, John Wiley &amp; Sons, New York-London-Sydney (2008).</li><li class="footnote" id="footnote-5"><a class="tag is-link" href="#citeref-5">5</a>M. A. Berstein, K. F. King &amp; X. J. Zhou, <em>Handbook of MRI pulse sequences</em>, Elsevier, Amsterdam (2004).</li><li class="footnote" id="footnote-6"><a class="tag is-link" href="#citeref-6">6</a>J. N. Rydberg, S. J. Riederer, C. H. Rydberg &amp; C. R. Jack, <em>Contrast optimization of fluid-attenuated inversion recovery (flair) imaging</em>, Magn. Reson. Med., <strong>34</strong> (1995), no. 6, 868–877.</li><li class="footnote" id="footnote-7"><a class="tag is-link" href="#citeref-7">7</a>S. Conolly, D. Nishimura &amp; A. Macovski, <em>Optimal control solutions to the magnetic resonance selective excitation problem</em>, IEEE Trans. Med. Imaging, <strong>5</strong> (1986), no. 2, 106–115.</li><li class="footnote" id="footnote-8"><a class="tag is-link" href="#citeref-8">8</a>N. Khaneja, S. J. Glaser &amp; R. Brockett, <em>Sub-Riemannian geometry and time optimal control of three spin systems: quantum gates and coherence transfer</em>, Phys. Rev. A, <strong>65</strong> (2002), no. 3, 032301, pp.11. Errata Phys. Rev. A <strong>68</strong> (2003), 049903; Phys. Rev. A <strong>71</strong> (2005), 039906.</li><li class="footnote" id="footnote-9"><a class="tag is-link" href="#citeref-9">9</a>T. E. Skinner, T. O. Reiss, B. Luy, N. Khaneja &amp; S. J. Glaser, <em>Application of optimal control theory to the design of broadband excitation pulses for high-resolution NMR</em>, J. Magn. Reson., <strong>163</strong> (2003), no. 1, 8–15.</li><li class="footnote" id="footnote-10"><a class="tag is-link" href="#citeref-10">10</a>L. S. Pontryagin, V. G. Boltyanskii, R. V. Gamkrelidze &amp; E. F. Mishchenko, <em>The Mathematical Theory of Optimal Processes</em>, Translated from the Russian by K. N. Trirogoff, edited by L. W. Neustadt, Interscience Publishers John Wiley &amp; Sons, Inc., New York-London, 1962.</li><li class="footnote" id="footnote-11"><a class="tag is-link" href="#citeref-11">11</a>N. Khaneja, T. Reiss, C. Kehlet, T. Schulte-Herbriiggen &amp; S. J. Glaser, <em>Optimal control of coupled spin dynamics: design of NMR pulse sequences by gradient ascent algorithms</em>, J. Magn. Reson., <strong>172</strong> (2005), no. 2, 296–305.</li><li class="footnote" id="footnote-12"><a class="tag is-link" href="#citeref-12">12</a>O. Cots, <em>Contrôle optimal géométrique : méthodes homotopiques et applications</em>, Phd thesis, Institut Mathématiques de Bourgogne, Dijon, France, 2012.</li><li class="footnote" id="footnote-13"><a class="tag is-link" href="#citeref-13">13</a>M. Lapert, Y. Zhang, M. Braun, S. J. Glaser &amp; D. Sugny, <em>Singular extremals for the time-optimal control of dissipative spin 1/2 particles</em>, Phys. Rev. Lett., <strong>104</strong> (2010), 083001.</li><li class="footnote" id="footnote-14"><a class="tag is-link" href="#citeref-14">14</a>B. Bonnard, M. Chyba &amp; J. Marriott, <em>Singular Trajectories and the Contrast Imaging Problem in Nuclear Magnetic resonance</em>, SIAM J. Control Optim., <strong>51</strong> (2013), no. 2, 1325–1349.</li><li class="footnote" id="footnote-15"><a class="tag is-link" href="#citeref-15">15</a>M. Lapert, Y. Zhang, M. A. Janich, S. J. Glaser &amp; D. Sugny, <em>Exploring the physical limits of saturation contrast in magnetic resonance imaging</em>, Sci. Rep., <strong>589</strong> (2012), no. 2.</li><li class="footnote" id="footnote-16"><a class="tag is-link" href="#citeref-16">16</a>B. Bonnard, O. Cots, S. Glaser, M. Lapert, D. Sugny &amp; Y. Zhang, *Geometric optimal control of the contrast imaging problem in nuclear magnetic resonance, IEEE Trans. Automat. Control, <strong>57</strong> (2012), no. 8, 1957–1969.</li><li class="footnote" id="footnote-17"><a class="tag is-link" href="#citeref-17">17</a>E. Van Reeth, H. Ratiney, M. Tesch, D. Grenier, O. Beuf, S. J. Glaser &amp;  D. Sugny, <em>Optimal control design of preparation pulses for contrast optimization in MRI</em>, J. Magn. Reson., <strong>279</strong> (2017), 39–50.</li><li class="footnote" id="footnote-18"><a class="tag is-link" href="#citeref-18">18</a>C. P. Koch, U. Boscain, T. Calarco, G. Dirr, S. Filipp, S. J. Glaser, R. Kosloff, S. Montangero, T. Schulte-Herbrüggen, D. Sugny &amp; F. K. Wilhelm, <em>Quantum optimal control in quantum technologies. strategic report on current status, visions and goals for research in europe</em>, EPJ Quantum Technology, 9 (2022), p. 60.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="bloch-equation.html">Bloch equation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Monday 26 August 2024 14:32">Monday 26 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
